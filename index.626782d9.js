var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},r={},n=e.parcelRequiref497;function o(e){const t=document.getElementById(e),r=document.getElementById(e+"_output");if(null==t||null==r)return alert("Broken code example, unable to find code id: "+e),!1;const n=t?.value;return n?(r.innerHTML="",{output:r,text:n}):(r.innerHTML="Needs text input to parse",!1)}null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in r){var n=r[e];delete r[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},e.parcelRequiref497=n),n.register("2mTEf",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.VirtualMachine=void 0;var r=n("6PleH"),o=n("2n3io"),a=n("iIv5n"),s=n("hxs7z"),i=n("aoVf1"),u=n("bDrYL"),c=n("4dh1X"),l=n("4OWy8"),p=n("2fEeR");e.exports.VirtualMachine=class{constructor(e){this.builtinScope=void 0,this._lineCounter=0,this.running=!1,this.paused=!1,this.currentCode=p.VMFunction.Empty,this._stack=[],this._stackTrace=[],this._stackSize=e,this._globalScope=new r.Scope,this._currentScope=this._globalScope}get globalScope(){return this._globalScope}get lineCounter(){return this._lineCounter}get stack(){return this._stack}get stackTrace(){return this._stackTrace}reset(){this._globalScope=new r.Scope,this._currentScope=this._globalScope,this._lineCounter=0,this._stack=[],this._stackTrace=[],this.running=!1,this.paused=!1}changeToScript(e){this._lineCounter=0,this._stack=[],this._stackTrace=[],this.builtinScope=e.builtinScope,this.currentCode=e.code}execute(e){for(this.changeToScript(e),this.running=!0,this.paused=!1;this.running&&!this.paused;)this.step()}step(){if(this._lineCounter>=this.currentCode.code.length)return void(this.tryCallReturn()||(this.running=!1));const e=this.currentCode.code[this._lineCounter++];switch(e.operator){default:throw new Error(`Unknown operator: ${e.operator}`);case"push":if(void 0===e.value)throw new Error(`${this.getScopeLine()}: Push needs an input`);this.pushStack(e.value);break;case"toArgument":{const t=e.value??this.popStack();if(!(0,i.isIArrayValue)(t))throw new Error(`${this.getScopeLine()}: Unable to convert argument value onto stack: ${t.toString()}`);this.pushStack(new a.ArrayValue(t.arrayValues(),!0));break}case"get":{const t=e.value??this.popStack();if(!(t instanceof c.StringValue))throw new Error(`${this.getScopeLine()}: Unable to get, input must be a string not: ${t.toString()}`);let r=this._currentScope.get(t.value);if(void 0!==r){this.pushStack(r);break}if(void 0!==this.builtinScope&&(r=this.builtinScope.get(t.value),void 0!==r)){this.pushStack(r);break}throw new Error(`${this.getScopeLine()}: Unable to get variable: ${t.toString()}`)}case"getProperty":{const t=e.value??this.popStack();if(!(0,i.isIArrayValue)(t))throw new Error(`${this.getScopeLine()}: Unable to get property, input needs to be an array: ${t.toString()}`);const r=this.popStack(),n=(0,l.getProperty)(r,t);if(void 0===n)throw new Error(`${this.getScopeLine()}: Unable to get property: ${t.toString()}`);this.pushStack(n);break}case"define":{const t=e.value??this.popStack(),r=this.popStack();this._currentScope.define(t.toString(),r);break}case"set":{const t=e.value??this.popStack(),r=this.popStack();if(!this._currentScope.set(t.toString(),r))throw new Error(`${this.getScopeLine()}: Unable to set variable that has not been defined: ${t.toString()} = ${r.toString()}`);break}case"jumpFalse":{const t=e.value??this.popStack();0===this.popStack().compareTo(s.BoolValue.False)&&this.jump(t.toString());break}case"jumpTrue":{const t=e.value??this.popStack();0===this.popStack().compareTo(s.BoolValue.True)&&this.jump(t.toString());break}case"jump":{const t=e.value??this.popStack();this.jump(t.toString());break}case"return":this.callReturn();break;case"call":{if(!(e.value instanceof u.NumberValue))throw new Error(`${this.getScopeLine()}: Call needs a num args code line input`);const t=e.value,r=this.popStack();if(!(0,i.isIFunctionValue)(r))throw new Error(`${this.getScopeLine()}: Call needs a function to run: ${r.toString()}`);this.callFunction(r,t.value,!0);break}case"callDirect":{const t=e.value;if(!(null!=t&&(0,i.isIArrayValue)(t)&&(0,i.isIFunctionValue)(t.tryGetIndex(0))&&t.tryGetIndex(1)instanceof u.NumberValue))throw new Error(`${this.getScopeLine()}: Call direct needs an array of the function and num args code line input`);this.callFunction(t.tryGetIndex(0),t.tryGetIndex(1).value,!0);break}case"stringConcat":{if(!(0,u.isNumberValue)(e.value))throw new Error(`${this.getScopeLine()}: StringConcat operator needs the number of args to concat`);const t=this.getArgs(e.value.value);this.pushStackString(t.value.join(""));break}case"+":this.pushStackNumber(this.getNumArg(e)+this.popStackNumber());break;case"-":{const t=this.getNumArg(e),r=this.popStackNumber();this.pushStackNumber(r-t);break}case"unaryNegative":this.pushStackNumber(-this.popStackNumber());break;case"*":this.pushStackNumber(this.getNumArg(e)*this.popStackNumber());break;case"/":{const t=this.getNumArg(e),r=this.popStackNumber();this.pushStackNumber(r/t);break}case"++":{if(null==e.value)throw new Error(`${this.getScopeLine()}: Inc operator needs code line variable`);const t=e.value.toString(),r=this._currentScope.getNumber(t);if(void 0===r)throw new Error(`${this.getScopeLine()}: Inc operator could not find variable: ${t}`);this._currentScope.set(t,new u.NumberValue(r+1));break}case"--":{if(null==e.value)throw new Error(`${this.getScopeLine()}: Dec operator needs code line variable`);const t=e.value.toString(),r=this._currentScope.getNumber(t);if(void 0===r)throw new Error(`${this.getScopeLine()}: Dec operator could not find variable: ${t}`);this._currentScope.set(t,new u.NumberValue(r-1));break}case"<":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(r.compareTo(t)<0);break}case"<=":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(r.compareTo(t)<=0);break}case"==":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(0==r.compareTo(t));break}case"!=":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(0!=r.compareTo(t));break}case">":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(r.compareTo(t)>0);break}case">=":{const t=e.value??this.popStack(),r=this.popStack();this.pushStackBool(r.compareTo(t)>=0);break}case"&&":this.pushStackBool(this.getBoolArg(e)&&this.popStackBool());break;case"||":this.pushStackBool(this.getBoolArg(e)||this.popStackBool());break;case"!":this.pushStackBool(!this.popStackBool())}}tryCallReturn(){const e=this._stackTrace.pop();return null!=e&&(this._currentScope=e.scope,this._lineCounter=e.lineNumber,this.currentCode=e.function,!0)}callReturn(){if(!this.tryCallReturn())throw new Error(`${this.getScopeLine()}: Unable to return, call stack empty`)}getArgs(e){if(0===e)return a.ArrayValue.Empty;let t=!1;const r=new Array(e);for(let n=0;n<e;n++){const o=this.popStack();o instanceof a.ArrayValue&&o.isArgumentValue&&(t=!0),r[e-n-1]=o}if(t){let e=[];for(const t of r)t instanceof a.ArrayValue&&t.isArgumentValue?e=e.concat(t.value):e.push(t);return new a.ArrayValue(e,!0)}return new a.ArrayValue(r,!0)}getNumArg(e){if(null==e.value)return this.popStackNumber();if((0,u.isNumberValue)(e.value))return e.value.value;throw new Error(`${this.getScopeLine()}: Error attempt to get number argument`)}getBoolArg(e){if(null==e.value)return this.popStackBool();if((0,s.isBoolValue)(e.value))return e.value.value;throw new Error(`${this.getScopeLine()}: Error attempt to get boolean argument`)}jump(e){const t=this.currentCode.labels[e];if(null==t)throw new Error(`${this.getScopeLine()}: Unable to jump to label: ${e}`);this._lineCounter=t}callFunction(e,t,r){const n=this.getArgs(t);e.invoke(this,n,r)}executeFunction(e,t,n=!1){n&&this.pushCurrentToStackTrace(),this.currentCode=e,this._currentScope=new r.Scope(this._currentScope),this._lineCounter=0;const s=Math.min(t.value.length,e.parameters.length);let i=0;for(;i<s;i++){const r=e.parameters[i];if(r.startsWith("...")){t=(0,o.sublist)(t,i,-1),this._currentScope.define(r.substring(3),t),i++;break}this._currentScope.define(r,t.value[i])}if(i<e.parameters.length){const t=e.parameters[i];if(!t.startsWith("..."))throw new Error("Function called without enough arguments: "+e.name);this._currentScope.define(t.substring(3),a.ArrayValue.Empty)}}pushCurrentToStackTrace(){this.pushToStackTrace({lineNumber:this._lineCounter,scope:this._currentScope,function:this.currentCode})}pushToStackTrace(e){if(this._stackTrace.length>=this._stackSize)throw new Error(`${this.getScopeLine()}: Unable to push to stack trace, stack is full`);this._stackTrace.push(e)}pushStack(e){if(this._stack.length>=this._stackSize)throw new Error(`${this.getScopeLine()}: Unable to push, stack full`);this._stack.push(e)}pushStackNumber(e){this.pushStack(new u.NumberValue(e))}pushStackString(e){this.pushStack(new c.StringValue(e))}pushStackBool(e){this.pushStack(new s.BoolValue(e))}popStack(){const e=this._stack.pop();if(void 0===e)throw new Error(`${this.getScopeLine()}: Popped empty stack`);return e}popStackCast(e){const t=this.popStack();if(e(t))return t;throw new Error(`${this.getScopeLine()}: Pop stack cast error`)}popStackNumber(){const e=this._stack.pop();if(!(0,u.isNumberValue)(e))throw new Error(`${this.getScopeLine()}: Pop stack error, not a number`);return e.value}popStackBool(){const e=this._stack.pop();if(!(0,s.isBoolValue)(e))throw new Error(`${this.getScopeLine()}: Pop stack error, not a boolean`);return e.value}peekStack(){if(0===this._stack.length)throw new Error(`${this.getScopeLine()}: Peek empty stack`);return this._stack[this._stack.length-1]}createStackTrace(){const e=[this.debugScopeLine(this.currentCode,this._lineCounter-1)];for(let t=this.stackTrace.length-1;t>=0;t--){const r=this._stackTrace[t];e.push(this.debugScopeLine(r.function,r.lineNumber))}return e}debugScopeLine(e,t){if(t>=e.code.length)return`[${e.name}]:${t-1}: end of code`;if(t<0)return`[${e.name}]:${t-1}: before start of code`;const r=e.code[t],n=null!=r.value?r.value.toString():"<empty>";return`[${e.name}]:${t-1}:${r.operator}: [${n}]`}getScopeLine(){return`${this.currentCode.name}:${this._lineCounter}`}}})),n.register("6PleH",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Scope=void 0;var r=n("evteC"),o=n("bDrYL");class a{constructor(e){this._values={},this._parent=e}get values(){return this._values}combineScope(e){for(const t in e.values)this.define(t,e.values[t])}define(e,t){this._values[e]=t}defineFunc(e,t,n=null){this._values[e]=new r.BuiltinFunctionValue(t,n??e)}set(e,t){return this._values.hasOwnProperty(e)?(this._values[e]=t,!0):!!this._parent&&this._parent.set(e,t)}get(e){const t=this._values[e];return null!=t?t:void 0!==this._parent?this._parent.get(e):void 0}getNumber(e){const t=this.get(e);if((0,o.isNumberValue)(t))return t.value}}e.exports.Scope=a,a.Empty=new a(void 0)})),n.register("evteC",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BuiltinFunctionValue=void 0;class r{constructor(e,t){this.value=e,this.name=t}typename(){return"builtin-function"}toString(){return`builtin-function:${this.name}`}compareTo(e){return e instanceof r&&this.value===e.value?0:1}invoke(e,t,r){this.value(e,t)}}e.exports.BuiltinFunctionValue=r})),n.register("bDrYL",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isNumberValue=e.exports.numberCompareTo=e.exports.NumberValue=void 0;class r{constructor(e){this.value=e}typename(){return"number"}toString(){return this.value.toString()}compareTo(e){return e instanceof r?n(this.value,e.value):1}}function n(e,t){const r=e-t;return Math.abs(r)<1e-4?0:r<0?-1:1}e.exports.NumberValue=r,e.exports.numberCompareTo=n,e.exports.isNumberValue=function(e){return e instanceof r}})),n.register("2n3io",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.sublist=e.exports.indexOf=e.exports.contains=e.exports.removeAll=e.exports.remove=e.exports.removeAt=e.exports.insertFlatten=e.exports.insert=e.exports.get=e.exports.set=e.exports.createArrayScope=e.exports.arrayScope=void 0;var r=n("6PleH"),o=n("iIv5n"),a=n("evteC"),s=n("aoVf1"),i=n("g0lkP"),u=n("5dKj2");function c(){const e=new r.Scope,t={join:new a.BuiltinFunctionValue(((e,t)=>{e.pushStack(new o.ArrayValue(t.value))}),"array.join"),length:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue);e.pushStackNumber(r.arrayValues().length)}),"array.length"),get:new a.BuiltinFunctionValue(((e,t)=>{const r=p(t.getIndexCast(0,o.isArrayValue),t.getNumber(1));void 0!==r?e.pushStack(r):e.pushStack(i.NullValue.Value)}),"array.get"),set:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getNumber(1),a=t.getIndex(2);e.pushStack(l(r,n,a))}),"array.set"),insert:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getNumber(1),a=t.getIndex(2);e.pushStack(h(r,n,a))}),"array.insert"),insertFlatten:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getNumber(1),a=t.getIndexCast(2,s.isIArrayValue);e.pushStack(g(r,n,a))}),"array.insertFlatten"),remove:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getIndex(1);e.pushStack(b(r,n))}),"array.remove"),removeAt:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getNumber(1);e.pushStack(f(r,n))}),"array.removeAt"),removeAll:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getIndex(1);e.pushStack(v(r,n))}),"array.removeAll"),contains:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getIndex(1);e.pushStackBool(S(r,n))}),"array.contains"),indexOf:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getIndex(1);e.pushStackNumber(d(r,n))}),"array.indexOf"),sublist:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,o.isArrayValue),n=t.getNumber(1),a=t.getNumber(2);e.pushStack(m(r,n,a))}),"array.sublist")};return e.define("array",new u.ObjectValue(t)),e}function l(e,t,r){let n=[...e.value];return n[e.calcIndex(t)]=r,new o.ArrayValue(n)}function p(e,t){return e.tryGetIndex(t)}function h(e,t,r){t=e.calcIndex(t);const n=[...e.value];return n.splice(t,0,r),new o.ArrayValue(n)}function g(e,t,r){t=e.calcIndex(t);const n=[...e.value];return n.splice(t,0,...r.arrayValues()),new o.ArrayValue(n)}function f(e,t){t=e.calcIndex(t);const r=[...e.value];return r.splice(t,1),new o.ArrayValue(r)}function b(e,t){const r=d(e,t);return r<0?e:f(e,r)}function v(e,t){return new o.ArrayValue(e.value.filter((e=>0!==e.compareTo(t))))}function S(e,t){return d(e,t)>=0}function d(e,t){return e.arrayValues().findIndex((e=>0===e.compareTo(t)))}function m(e,t,r){return t=e.calcIndex(t),r<0?new o.ArrayValue(e.value.slice(t)):new o.ArrayValue(e.value.slice(t,t+r))}e.exports.arrayScope=c(),e.exports.createArrayScope=c,e.exports.set=l,e.exports.get=p,e.exports.insert=h,e.exports.insertFlatten=g,e.exports.removeAt=f,e.exports.remove=b,e.exports.removeAll=v,e.exports.contains=S,e.exports.indexOf=d,e.exports.sublist=m})),n.register("iIv5n",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isArrayValue=e.exports.arrayCompareTo=e.exports.ArrayValue=void 0;var r=n("hxs7z"),o=n("bDrYL"),a=n("4dh1X");const s=["length"];class i{constructor(e,t=!1){this.value=e,this.isArgumentValue=t}typename(){return this.isArgumentValue?"arguments":"array"}toString(){let e=!0,t="(";for(const r of this.value)e||(t+=" "),e=!1,t+=r.toString();return t+=")",t}arrayValues(){return this.value}compareTo(e){return this===e?0:e instanceof i?u(this,e):1}calcIndex(e){return e<0?this.value.length+e:e}tryGetIndex(e){return this.value[this.calcIndex(e)]}getIndex(e){if(e<0||e>=this.value.length)throw new Error("Out of index");return this.value[e]}getIndexCast(e,t){const r=this.value[e];if(t(r))return r;throw new Error(`Unable to get argument: [${e}] failed guard check`)}getNumber(e){return this.getIndexCast(e,o.isNumberValue).value}getString(e){return this.getIndexCast(e,a.isStringValue).value}getBool(e){return this.getIndexCast(e,r.isBoolValue).value}tryGetKey(e){if("length"===e)return new o.NumberValue(this.value.length)}objectKeys(){return s}}function u(e,t){const r=e.arrayValues(),n=t.arrayValues(),a=(0,o.numberCompareTo)(r.length,n.length);if(0!==a)return a;for(let e=0;e<r.length;e++){const t=r[e].compareTo(n[e]);if(0!==t)return t}return 0}e.exports.ArrayValue=i,i.Empty=new i([],!1),i.EmptyArgs=new i([],!0),e.exports.arrayCompareTo=u,e.exports.isArrayValue=function(e){return void 0!==e&&e instanceof i}})),n.register("hxs7z",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isBoolValue=e.exports.boolCompareTo=e.exports.BoolValue=void 0;class r{constructor(e){this.value=e}typename(){return"boolean"}toString(){return this.value?"true":"false"}compareTo(e){return e instanceof r?n(this.value,e.value):1}}function n(e,t){return e===t?0:e?-1:1}e.exports.BoolValue=r,r.True=new r(!0),r.False=new r(!1),e.exports.boolCompareTo=n,e.exports.isBoolValue=function(e){return e instanceof r}})),n.register("4dh1X",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isStringValue=e.exports.StringValue=void 0;var r=n("bDrYL");const o=["length"];class a{constructor(e){this.value=e}typename(){return"string"}toString(){return this.value}compareTo(e){if(!(e instanceof a))return 1;const t=this.value.localeCompare(e.value);return 0==t?0:t<0?-1:1}getIndex(e){return e<0?this.value.length+e:e}tryGetKey(e){if("length"===e)return new r.NumberValue(this.value.length)}objectKeys(){return o}}e.exports.StringValue=a,e.exports.isStringValue=function(e){return e instanceof a}})),n.register("aoVf1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isIFunctionValue=e.exports.isIObjectValue=e.exports.isIArrayValue=void 0,e.exports.isIArrayValue=function(e){return void 0!==e&&"function"==typeof e.arrayValues},e.exports.isIObjectValue=function(e){return void 0!==e&&"function"==typeof e.objectKeys},e.exports.isIFunctionValue=function(e){return void 0!==e&&"function"==typeof e.invoke}})),n.register("g0lkP",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.NullValue=void 0;class r{typename(){return"null"}toString(){return"null"}compareTo(e){return e instanceof r?0:1}}e.exports.NullValue=r,r.Value=new r})),n.register("5dKj2",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isObjectValue=e.exports.ObjectValue=void 0;var r=n("bDrYL");class o{constructor(e){this.value=e,this.keys=Object.keys(e)}typename(){return"object"}toString(){let e=!0,t="{";for(const r in this.value)e||(t+=" "),e=!1,t+=`"${r}" `,t+=this.value[r].toString();return t+="}",t}compareTo(e){if(this===e)return 0;if(!(e instanceof o))return 1;const t=(0,r.numberCompareTo)(this.keys.length,e.keys.length);if(0!==t)return t;for(const t in this.value){const r=e.value[t];if(void 0===r)return 1;const n=this.value[t].compareTo(r);if(0!==n)return n}return 0}tryGetKey(e){return this.value[e]}objectKeys(){return this.keys}}e.exports.ObjectValue=o,e.exports.isObjectValue=function(e){return void 0!==e&&e instanceof o}})),n.register("4OWy8",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.parseIndex=e.exports.getProperty=void 0;var r=n("aoVf1"),o=n("bDrYL"),a=n("4dh1X"),s=n("k9sml");function i(e){if(e instanceof o.NumberValue)return e.value;if(e instanceof a.StringValue||e instanceof s.VariableValue){const t=parseInt(e.value);return isFinite(t)?t:void 0}}e.exports.getProperty=function(e,t){const n=t.arrayValues();for(let t=0;t<n.length;t++){const o=i(n[t]);if(void 0!==o&&(0,r.isIArrayValue)(e)){const t=e.tryGetIndex(o);if(void 0===t)return;e=t}else{if(!(0,r.isIObjectValue)(e))return;{const r=e.tryGetKey(n[t].toString());if(void 0===r)return;e=r}}}return e},e.exports.parseIndex=i})),n.register("k9sml",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.VariableValue=void 0;class r{constructor(e){this.value=e}get isLabel(){return this.value.length>0&&":"===this.value[0]}typename(){return"variable"}toString(){return this.value}compareTo(e){if(!(e instanceof r))return 1;const t=this.value.localeCompare(e.value);return 0==t?0:t<0?-1:1}}e.exports.VariableValue=r})),n.register("2fEeR",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.VMFunction=void 0;class r{constructor(e,t,r,n){this.code=e,this.parameters=t,this.labels=r,this.name=n.length>0?n:"anonymous",this.hasName=n.length>0}get isEmpty(){return 0==this.code.length}}e.exports.VMFunction=r,r.Empty=new r([],[],{},"")})),n.register("bvNc9",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.VirtualMachineAssembler=void 0;var r=n("c6Xys"),o=n("6PleH"),a=n("ldWkU"),s=n("iIv5n"),i=n("eUVip"),u=n("aoVf1"),c=n("bDrYL"),l=n("4dh1X"),p=n("4OWy8"),h=n("k9sml"),g=n("2fEeR");const f="function",b="continue",v="break";function S(e,t){return{operator:e,value:t}}function d(e){return{label:e}}class m{constructor(){this.builtinScope=new o.Scope,this.labelCount=0,this.loopStack=[],this.keywordParsingStack=[]}parseFromText(e){const t=(0,r.tokenize)(e),n=(0,r.readAllTokens)(t),s=this.parseGlobalFunction(n),i=new o.Scope;return i.combineScope(this.builtinScope),new a.Script(i,s)}parse(e){if(e instanceof s.ArrayValue){if(0===e.value.length)return[];const t=e.value[0];if(t instanceof h.VariableValue){const r=t.toString();if(t.isLabel)return[d(r)];const n=this.parseKeyword(r,e);if(n.length>0)return n;this.keywordParsingStack.push("func-call");let o=e.value.slice(1).map((e=>this.parse(e))).flat(1);return o=o.concat(this.optimiseCallSymbolValue(t.value,e.value.length-1)),this.keywordParsingStack.pop(),o}}else if(e instanceof h.VariableValue&&!e.isLabel)return this.optimiseGetSymbolValue(e.value);return[S("push",e)]}parseDefineSet(e,t){const r=t?"define":"set",n=this.parse(e.value[e.value.length-1]);for(let t=e.value.length-2;t>=1;t--)n.push(S(r,e.value[t]));return n}parseLoop(e){if(e.value.length<3)throw new Error("Loop input has too few arguments");const t=this.labelCount++,r=`:LoopStart${t}`,n=`:LoopEnd${t}`;this.loopStack.push({start:r,end:n});const o=e.value[1];let a=[d(r),...this.parse(o)];a.push(S("jumpFalse",new l.StringValue(n)));for(let t=2;t<e.value.length;t++)a=a.concat(this.parse(e.value[t]));return a.push(S("jump",new l.StringValue(r))),a.push(d(n)),this.loopStack.pop(),a}parseCond(e,t){if(e.value.length<3)throw new Error("Condition input has too few inputs");if(e.value.length>4)throw new Error("Condition input has too many inputs!");const r=this.labelCount++,n=`:CondElse${r}`,o=`:CondEnd${r}`,a=4===e.value.length,s=t?"jumpFalse":"jumpTrue",i=e.value[1],u=e.value[2];let c=this.parse(i);if(a){c.push(S(s,new l.StringValue(n))),c=c.concat(this.parseFlatten(u)),c.push(S("jump",new l.StringValue(o))),c.push(d(n));const t=e.value[3];c=c.concat(this.parseFlatten(t))}else c.push(S(s,new l.StringValue(o))),c=c.concat(this.parseFlatten(u));return c.push(d(o)),c}parseFlatten(e){return e.value.every(u.isIArrayValue)?e.value.map((e=>this.parse(e))).flat(1):this.parse(e)}parseLoopJump(e,t){if(0===this.loopStack.length)throw new Error(`Unexpected ${e} outside of loop`);const r=this.loopStack[this.loopStack.length-1];return[S("jump",new l.StringValue(t?r.start:r.end))]}parseFunction(e){let t="",r=0;if((e.value[1]instanceof h.VariableValue||e.value[1]instanceof l.StringValue)&&(t=e.value[1].toString(),r=1),!(0,u.isIArrayValue)(e.value[1+r]))throw new Error("Function needs parameter array");const n=e.value[1+r].arrayValues().map((e=>e.toString())),o=e.value.slice(2+r).map((e=>this.parse(e))).flat(1);return this.processTempFunction(n,o,t)}parseGlobalFunction(e){const t=e.value.map((e=>this.parse(e))).flat(1);return this.processTempFunction([],t,"global")}processTempFunction(e,t,r){const n={},o=[];for(const e of t)void 0!==e.label&&""!=e.label?n[e.label]=o.length:void 0!==e.operator&&o.push({operator:e.operator,value:e.value});return new g.VMFunction(o,e,n,r)}parseChangeVariable(e,t){const r=new l.StringValue(e.toString());return[S("get",r),S("callDirect",new s.ArrayValue([t,new c.NumberValue(1)])),S("set",r)]}parseJump(e){let t=this.parse(e.value[1]);return 1===t.length&&"push"===t[0].operator&&void 0!==t[0].value?[S("jump",t[0].value)]:(t.push(S("push")),t)}parseReturn(e){const t=e.value.slice(1).map((e=>this.parse(e))).flat(1);return t.push(S("return")),t}parseFunctionKeyword(e){const t=this.parseFunction(e),r=[S("push",new i.FunctionValue(t))],n=this.keywordParsingStack.length>1?this.keywordParsingStack[this.keywordParsingStack.length-1]:f;return t.hasName&&n===f&&r.push(S("define",new l.StringValue(t.name))),r}parseNegative(e){if(e.value.length>=3)return this.parseOperator("-",e);if(2===e.value.length){if((0,c.isNumberValue)(e.value[1]))return[S("push",new c.NumberValue(-e.value[1].value))];const t=this.parse(e.value[1]);return t.push(S("unaryNegative")),t}throw new Error("Negative/Sub operator expects at least 1 input")}parseOnePushInput(e,t){if(t.value.length<2)throw new Error(`Expecting at least 1 input for: ${e}`);let r=[];for(let n=1;n<t.value.length;n++)r=r.concat(this.parse(t.value[n])),r.push(S(e));return r}parseOperator(e,t){if(t.value.length<3)throw new Error(`Expecting at least 3 inputs for: ${e}`);let r=this.parse(t.value[1]);for(let n=2;n<t.value.length;n++){const o=t.value[n];(0,c.isNumberValue)(o)?r.push(S(e,o)):(r=r.concat(this.parse(o)),r.push(S(e)))}return r}parseOneVariableUpdate(e,t){if(t.value.length<2)throw new Error(`Expecting at least 1 input for: ${e}`);let r=[];for(let n=1;n<t.value.length;n++){const o=new l.StringValue(t.value[n].toString());r.push(S(e,o))}return r}parseStringConcat(e){const t=e.value.slice(1).map((e=>this.parse(e))).flat(1);return t.push(S("stringConcat",new c.NumberValue(e.value.length-1))),t}transformAssignmentOperator(e){let t=e.value[0].toString();t=t.substring(0,t.length-1);const r=e.value[1].toString(),n=[...e.value];n[0]=new h.VariableValue(t);const o=[new h.VariableValue("set"),new h.VariableValue(r),new s.ArrayValue(n)];return this.parse(new s.ArrayValue(o))}parseKeyword(e,t){let r=null;switch(this.keywordParsingStack.push(e),e){case f:r=this.parseFunctionKeyword(t);break;case b:r=this.parseLoopJump(b,!0);break;case v:r=this.parseLoopJump(v,!1);break;case"set":r=this.parseDefineSet(t,!1);break;case"define":r=this.parseDefineSet(t,!0);break;case"loop":r=this.parseLoop(t);break;case"if":r=this.parseCond(t,!0);break;case"unless":r=this.parseCond(t,!1);break;case"jump":r=this.parseJump(t);break;case"return":r=this.parseReturn(t);break;case"+":case"*":case"/":r=this.parseOperator(e,t);break;case"-":r=this.parseNegative(t);break;case"++":case"--":r=this.parseOneVariableUpdate(e,t);break;case"<":case"<=":case"==":case"!=":case">":case">=":case"&&":case"||":r=this.parseOperator(e,t);break;case"!":r=this.parseOnePushInput("!",t);break;case"$":r=this.parseStringConcat(t);break;case"+=":case"-=":case"*=":case"/=":case"&&=":case"||=":case"$=":r=this.transformAssignmentOperator(t)}return this.keywordParsingStack.pop(),null!=r?r:[]}optimiseCallSymbolValue(e,t){const r=new c.NumberValue(t),n=m.isGetPropertyRequest(e),o=this.builtinScope.get(n.parentKey);if(void 0!==o){let t;if(n.isPropertyRequest&&void 0!==(t=(0,p.getProperty)(o,n.property))){if((0,u.isIFunctionValue)(t)){return[S("callDirect",new s.ArrayValue([t,r]))]}throw new Error(`Attempting to call a value that is not a function: ${e} = ${t.toString()}`)}if(!n.isPropertyRequest){if((0,u.isIFunctionValue)(o)){return[S("callDirect",new s.ArrayValue([o,r]))]}throw new Error(`Attempting to call a value that is not a function: ${e} = ${o.toString()}`)}}const a=[S("get",new l.StringValue(n.parentKey))];return n.isPropertyRequest&&a.push(S("getProperty",n.property)),a.push(S("call",r)),a}optimiseGetSymbolValue(e){let t=!1;e.startsWith("...")&&(t=!0,e=e.substring(3));const r=[],n=m.isGetPropertyRequest(e),o=this.builtinScope.get(n.parentKey);if(void 0!==o)if(n.isPropertyRequest){const e=(0,p.getProperty)(o,n.property);void 0!==e?r.push(S("push",e)):(r.push(S("push",o)),r.push(S("getProperty",n.property)))}else n.isPropertyRequest||r.push(S("push",o));else r.push(S("get",new l.StringValue(n.parentKey))),n.isPropertyRequest&&r.push(S("getProperty",n.property));return t&&r.push(S("toArgument",void 0)),r}static isGetPropertyRequest(e){if(e.includes(".")){const t=e.split(".");return{isPropertyRequest:!0,parentKey:t[0],property:new s.ArrayValue(t.slice(1).map((e=>new h.VariableValue(e))))}}return{isPropertyRequest:!1,parentKey:e,property:s.ArrayValue.Empty}}}e.exports.VirtualMachineAssembler=m})),n.register("c6Xys",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.readFromTokens=e.exports.readAllTokens=e.exports.tokenize=void 0;var r=n("iIv5n"),o=n("hxs7z"),a=n("g0lkP"),s=n("bDrYL"),i=n("5dKj2"),u=n("4dh1X"),c=n("k9sml");function l(e){if(0===e.length)throw new Error("Unexpected end of tokens");const t=p(e);if("("===t){const t=[];for(;")"!==e[0];)t.push(l(e));return p(e),new r.ArrayValue(t)}if(")"===t)throw new Error("Unexpected )");if("{"===t){const t={};for(;"}"!==e[0];){const r=l(e).toString(),n=l(e);t[r]=n}return p(e),new i.ObjectValue(t)}if("}"===t)throw new Error("Unexpected }");return function(e){const t=parseFloat(e);if(!isNaN(t))return new s.NumberValue(t);if("true"===e)return o.BoolValue.True;if("false"===e)return o.BoolValue.False;if("null"===e)return a.NullValue.Value;const r=e[0],n=e[e.length-1];return'"'===r&&'"'===n||"'"===r&&"'"===n?new u.StringValue(e.substring(1,e.length-1)):new c.VariableValue(e)}(t)}function p(e){if(0===e.length)throw new Error("Unable to pop empty list");const t=e[0];return e.splice(0,1),t}e.exports.tokenize=function(e){let t="\0",r=!1,n=!1,o="",a=0;const s=[];for(;a<e.length;){const i=e.charAt(a++);if(n)"\n"!==i&&"\r"!==i||(n=!1);else if("\0"!=t){if(r){switch(i){case'"':case"'":case"\\":o+=i;break;case"t":o+="\t";break;case"r":o+="\r";break;case"n":o+="\n"}r=!1;continue}if("\\"==i){r=!0;continue}o+=i,i==t&&(s.push(o),o="",t="\0")}else switch(i){case";":n=!0;break;case'"':case"'":t=i,o+=i;break;case"(":case")":case"{":case"}":o.length>0&&(s.push(o),o=""),s.push(i);break;case" ":case"\t":case"\n":case"\r":o.length>0&&(s.push(o),o="");break;default:o+=i}}return s},e.exports.readAllTokens=function(e){const t=[];for(;e.length>0;)t.push(l(e));return new r.ArrayValue(t)},e.exports.readFromTokens=l})),n.register("ldWkU",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Script=void 0;var r=n("6PleH"),o=n("2fEeR");class a{constructor(e,t){this.builtinScope=e,this.code=t}}e.exports.Script=a,a.Empty=new a(r.Scope.Empty,o.VMFunction.Empty)})),n.register("eUVip",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.FunctionValue=void 0;class r{constructor(e){this.value=e}typename(){return"function"}toString(){return"function:"+this.value.name}compareTo(e){return this===e||e instanceof r&&this.value===e.value?0:1}invoke(e,t,r){e.executeFunction(this.value,t,r)}}e.exports.FunctionValue=r})),n.register("kzUiW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.VirtualMachineRunner=void 0;e.exports.VirtualMachineRunner=class{constructor(e){this.running=!1,this.waitUntil=-1,this.vmStepTiming=-1,this.isWaiting=!1,this.interval=-1,this.onComplete=()=>{},this.step=e=>{if(!this.running)return;let t=!1;for(;this._vm.running&&!this._vm.paused;){if(this.waitUntil>0){if(this.waitUntil-=e,t||this.waitUntil>0)break;this.waitUntil=this.vmStepTiming}else this.waitUntil=this.vmStepTiming;t=!0,this.isWaiting=!1,this._vm.step()}this._vm.running||(this.running=!1,this.onComplete(null),clearInterval(this.interval))},this._vm=e}get vm(){return this._vm}start(){return this.running=!0,this._vm.running=!0,this.interval=setInterval(this.step,1),new Promise(((e,t)=>{this.onComplete=e}))}}})),n.register("1kGNJ",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=e.exports&&e.exports.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(e.exports,"__esModule",{value:!0}),o(n("iIv5n"),e.exports),o(n("hxs7z"),e.exports),o(n("evteC"),e.exports),o(n("eUVip"),e.exports),o(n("aoVf1"),e.exports),o(n("g0lkP"),e.exports),o(n("bDrYL"),e.exports),o(n("5dKj2"),e.exports),o(n("4dh1X"),e.exports),o(n("k9sml"),e.exports)})),n.register("eeeBG",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.addToScope=e.exports.LibraryType=e.exports.miscScope=e.exports.objectScope=e.exports.arrayScope=e.exports.stringScope=e.exports.mathScope=void 0;var r=n("iTXlX"),o=n("fN49V"),a=n("2n3io"),s=n("4uGgY"),i=n("f6Hda");r=n("iTXlX");Object.defineProperty(e.exports,"mathScope",{enumerable:!0,get:function(){return r.mathScope}});o=n("fN49V");Object.defineProperty(e.exports,"stringScope",{enumerable:!0,get:function(){return o.stringScope}});a=n("2n3io");Object.defineProperty(e.exports,"arrayScope",{enumerable:!0,get:function(){return a.arrayScope}});s=n("4uGgY");Object.defineProperty(e.exports,"objectScope",{enumerable:!0,get:function(){return s.objectScope}});var u,c;i=n("f6Hda");Object.defineProperty(e.exports,"miscScope",{enumerable:!0,get:function(){return i.miscScope}}),(c=u=e.exports.LibraryType||(e.exports.LibraryType={}))[c.math=1]="math",c[c.string=2]="string",c[c.array=4]="array",c[c.object=8]="object",c[c.misc=16]="misc",c[c.all=31]="all",e.exports.addToScope=function(e,t){t&u.math&&e.combineScope(r.mathScope),t&u.string&&e.combineScope(o.stringScope),t&u.array&&e.combineScope(a.arrayScope),t&u.object&&e.combineScope(s.objectScope),t&u.misc&&e.combineScope(i.miscScope)}})),n.register("iTXlX",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.createMathScope=e.exports.mathScope=void 0;var r=n("6PleH"),o=n("evteC"),a=n("bDrYL"),s=n("5dKj2");const i=Math.PI/180;function u(){const e=new r.Scope,t={E:new a.NumberValue(Math.E),PI:new a.NumberValue(Math.PI),DegToRad:new a.NumberValue(i),sin:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.sin(t.getNumber(0)))}),"math.sin"),cos:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.cos(t.getNumber(0)))}),"math.cos"),tan:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.tan(t.getNumber(0)))}),"math.tan"),exp:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.exp(t.getNumber(0)))}),"math.exp"),ceil:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.ceil(t.getNumber(0)))}),"math.ceil"),floor:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.floor(t.getNumber(0)))}),"math.floor"),round:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.round(t.getNumber(0)))}),"math.round"),isFinite:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackBool(Number.isFinite(t.getNumber(0)))}),"math.isFinite"),isNaN:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackBool(isNaN(t.getNumber(0)))}),"math.isNaN"),parse:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndex(0);(0,a.isNumberValue)(r)?e.pushStack(r):e.pushStackNumber(parseFloat(r.toString()))}),"math.parse"),log:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.log(t.getNumber(0)))}),"math.log"),abs:new o.BuiltinFunctionValue(((e,t)=>{e.pushStackNumber(Math.abs(t.getNumber(0)))}),"math.abs"),max:new o.BuiltinFunctionValue(((e,t)=>{let r=t.value[0];for(let e=1;e<t.value.length;e++){const n=t.value[e];n.compareTo(r)>0&&(r=n)}e.pushStack(r)}),"math.max"),min:new o.BuiltinFunctionValue(((e,t)=>{let r=t.value[0];for(let e=1;e<t.value.length;e++){const n=t.value[e];n.compareTo(r)<0&&(r=n)}e.pushStack(r)}),"math.min"),sum:new o.BuiltinFunctionValue(((e,t)=>{let r=0;for(let e=0;e<t.value.length;e++){const n=t.value[e];if(!(0,a.isNumberValue)(n))throw new Error("Addition operator expects all numbers");r+=n.value}e.pushStackNumber(r)}),"math.sum")};return e.define("math",new s.ObjectValue(t)),e}e.exports.mathScope=u(),e.exports.createMathScope=u})),n.register("fN49V",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.substring=e.exports.removeAll=e.exports.removeAt=e.exports.insert=e.exports.set=e.exports.createStringScope=e.exports.stringScope=void 0;var r=n("6PleH"),o=n("evteC"),a=n("5dKj2"),s=n("4dh1X");function i(){const e=new r.Scope,t={join:new o.BuiltinFunctionValue(((e,t)=>{if(t.value.length<2)throw new Error("Not enough arguments for string join");const r=t.value[0],n=t.value.slice(1).join(r.toString());e.pushStackString(n)}),"string.join"),length:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getString(0);e.pushStackNumber(r.length)}),"string.length"),get:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getNumber(1);e.pushStackString(r.value[r.getIndex(n)])}),"string.get"),set:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getNumber(1),o=t.getIndex(2).toString();e.pushStack(u(r,n,o))}),"string.set"),insert:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getNumber(1),o=t.getIndex(2).toString();e.pushStack(c(r,n,o))}),"string.insert"),substring:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getNumber(1),o=t.getNumber(2);e.pushStack(h(r,n,o))}),"string.substring"),removeAt:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getNumber(1);e.pushStack(l(r,n))}),"string.removeAt"),removeAll:new o.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,s.isStringValue),n=t.getIndex(1).toString();e.pushStack(p(r,n))}),"string.removeAll")};return e.define("string",new a.ObjectValue(t)),e}function u(e,t,r){return t=e.getIndex(t),new s.StringValue(`${e.value.substring(0,t)}${r}${e.value.substring(t+1)}`)}function c(e,t,r){return t=e.getIndex(t),new s.StringValue(`${e.value.substring(0,t)}${r}${e.value.substring(t)}`)}function l(e,t){return t=e.getIndex(t),new s.StringValue(`${e.value.substring(0,t)}${e.value.substring(t+1)}`)}function p(e,t){return new s.StringValue(e.value.replace(t,""))}function h(e,t,r){return t=e.getIndex(t),new s.StringValue(e.value.substring(t,t+r))}e.exports.stringScope=i(),e.exports.createStringScope=i,e.exports.set=u,e.exports.insert=c,e.exports.removeAt=l,e.exports.removeAll=p,e.exports.substring=h})),n.register("4uGgY",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.length=e.exports.values=e.exports.removeValues=e.exports.removeKey=e.exports.keys=e.exports.get=e.exports.set=e.exports.createObjectScope=e.exports.objectScope=void 0;var r=n("6PleH"),o=n("iIv5n"),a=n("evteC"),s=n("g0lkP"),i=n("5dKj2"),u=n("4dh1X");function c(){const e=new r.Scope,t={set:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue),n=t.getString(1),o=t.getIndex(2);e.pushStack(l(r,n,o))}),"object.set"),get:new a.BuiltinFunctionValue(((e,t)=>{const r=p(t.getIndexCast(0,i.isObjectValue),t.getString(1));void 0!==r?e.pushStack(r):e.pushStack(s.NullValue.Value)}),"object.get"),removeKey:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue),n=t.getString(1);e.pushStack(g(r,n))}),"object.removeKey"),removeValues:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue),n=t.getIndex(1);e.pushStack(f(r,n))}),"object.removeValues"),keys:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue);e.pushStack(h(r))}),"object.keys"),values:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue);e.pushStack(b(r))}),"object.values"),length:new a.BuiltinFunctionValue(((e,t)=>{const r=t.getIndexCast(0,i.isObjectValue);e.pushStackNumber(v(r))}),"object.length")};return e.define("object",new i.ObjectValue(t)),e}function l(e,t,r){return new i.ObjectValue({...e.value,[t]:r})}function p(e,t){const r=e.value[t];return null!=r?r:void 0}function h(e){return new o.ArrayValue(e.keys.map((e=>new u.StringValue(e))))}function g(e,t){if(!e.value.hasOwnProperty(t))return e;const r={...e.value};return delete r[t],new i.ObjectValue(r)}function f(e,t){const r={};for(const n in e.value)0!==e.value[n].compareTo(t)&&(r[n]=e.value[n]);return new i.ObjectValue(r)}function b(e){return new o.ArrayValue(Object.values(e.value))}function v(e){return e.keys.length}e.exports.objectScope=c(),e.exports.createObjectScope=c,e.exports.set=l,e.exports.get=p,e.exports.keys=h,e.exports.removeKey=g,e.exports.removeValues=f,e.exports.values=b,e.exports.length=v})),n.register("f6Hda",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.createMiscScope=e.exports.miscScope=void 0;var r=n("6PleH");function o(){const e=new r.Scope;return e.defineFunc("toString",((e,t)=>{e.pushStackString(t.getIndex(0).toString())})),e.defineFunc("typeof",((e,t)=>{e.pushStackString(t.getIndex(0).typename())})),e.defineFunc("compareTo",((e,t)=>{e.pushStackNumber(t.getIndex(0).compareTo(t.getIndex(1)))})),e.defineFunc("print",((e,t)=>{console.log(t.value.map((e=>e.toString())).join(""))})),e}e.exports.miscScope=o(),e.exports.createMiscScope=o}));var a={},s=a&&a.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=a&&a.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(a,"__esModule",{value:!0}),i(n("2mTEf"),a),i(n("bvNc9"),a),i(n("6PleH"),a),i(n("ldWkU"),a),i(n("2fEeR"),a),i(n("kzUiW"),a),i(n("1kGNJ"),a),i(n("eeeBG"),a),globalThis.runStdLib=function(e){const t=o(e);if(!1===t)return;const r=new(0,a.VirtualMachineAssembler);(0,a.addToScope)(r.builtinScope,a.LibraryType.all),r.builtinScope.defineFunc("print",((e,r)=>{const n=r.value.map((e=>e.toString())).join("");console.log(n),t.output.innerHTML+=n+"<br/>"}));const n=r.parseFromText(t.text);new(0,a.VirtualMachine)(16).execute(n)};const u=function(){const e=new(0,a.Scope),t={pick:new(0,a.BuiltinFunctionValue)(((e,t)=>{let r=t;if(1===t.value.length){const e=t.getIndexCast(0,a.isArrayValue);e&&(r=e)}const n=Math.floor(Math.random()*r.arrayValues().length);e.pushStack(r.arrayValues()[n])}),"random.pick")};return e.define("random",new(0,a.ObjectValue)(t)),e}(),c=new(0,a.Scope);c.defineFunc("setBackground",((e,t)=>{document.body.setAttribute("background",t.getString(0))})),c.defineFunc("setTheme",((e,t)=>{document.body.setAttribute("theme",t.getString(0))})),globalThis.runPageSetup=function(){const e=o("codePageSetup");if(!1===e)return;const t=new(0,a.VirtualMachineAssembler);(0,a.addToScope)(t.builtinScope,a.LibraryType.all),t.builtinScope.combineScope(c),t.builtinScope.combineScope(u),t.builtinScope.defineFunc("print",((t,r)=>{const n=r.value.map((e=>e.toString())).join("");console.log(n),e.output.innerHTML+=n+"<br/>"}));const r=t.parseFromText(e.text);new(0,a.VirtualMachine)(16).execute(r)};const l=new(0,a.Scope);l.defineFunc("rand",((e,t)=>{e.pushStackNumber(Math.random())})),globalThis.runPerfTest=function(){const e=o("codePerfTest");if(!1===e)return;const t=new(0,a.VirtualMachineAssembler);t.builtinScope.combineScope(l),t.builtinScope.defineFunc("print",((t,r)=>{const n=r.value.map((e=>e.toString())).join("");console.log(n),e.output.innerHTML+=n+"<br/>"}));const r=t.parseFromText(e.text),n=new(0,a.VirtualMachine)(16),s=Date.now();n.execute(r);const i=Date.now();e.output.innerHTML+=`Time taken: ${i-s}ms <br/>`};
//# sourceMappingURL=index.626782d9.js.map
